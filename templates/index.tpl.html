<!DOCTYPE html>
<html class="no-js" id="ng-app" ng-app="app" ng-controller="AppCtrl">
  <head>
    <title ng-bind="pageTitle"></title>
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <link rel="stylesheet" type="text/css" href="/shopsense-proto-0.0.1.css">
    {{#interpolatedScript type="text/javascript"}}
      window.bootstrappedData = {{json $data}};
    {{/interpolatedScript}}
    <script ng-if="js" type="text/javascript" src="/shopsense-proto-0.0.1.js"></script>

    <style type="text/css">
      [data-hbs-hide] {
        display: none !important;
      }

      .search-result {
        position: relative !important;
        top: 0 !important;
        left: 0 !important;
        float: left !important;
        margin-left: 15px !important;
        margin-top: 15px !important;
        display: inline-block !important;
      }

      h1 {
        text-transform: capitalize;
      }

      .js-button {
        position: fixed !important;
        top: 5px;
        right: 5px;
        z-index: 100;
        color: black !important;
        line-height: 15px !important;
      }
    </style>

  </head>
  <body ui-event="{ dragover: '$event.preventDefault()', drop: '$event.preventDefault()' }">
    <header class="header hidden-xs">
      <img class="logo" src="http://proto.shopsense.s3-website-us-west-2.amazonaws.com/assets/images/shopsense-logo.png">

      <nav class="navbar navbar-default main-nav" role="navigation">
        <ul class="nav navbar-nav">
          <li class="{{ openTab.name == 'search' ? 'active' : '' }}">
            <a href="/search" ng-model="openTab.name" btn-radio="'search'"><i class="fa fa-search"></i> Search</a>
          </li>
          <!--           <li class="hidden-xs" class="dropdown" class="{{ openTab.name == 'tools' ? 'active' : '' }}">
            <a href="#/tools">Tools</a>
          </li> -->
          <li class="{{ openTab.name == 'insights' ? 'active' : '' }}">
            <a href="/insights" ng-model="openTab.name" btn-radio="'insights'"><i class="fa fa-bar-chart-o"></i> Insights</a>
          </li>
          <li class="{{ openTab.name == 'account' ? 'active' : '' }}">
            <a href="/account" ng-model="openTab.name" btn-radio="'account'"><i class="fa fa-user"></i> Account</a>
          </li>
          <li class="{{ openTab.name == 'tag' ? 'active' : '' }}">
            <a href="/tag" ng-model="openTab.name" btn-radio="'tag'"><i class="fa fa-circle-o"></i> Tag Photo</a>
          </li>
          <li class="{{ openTab.name == 'tools' ? 'active' : '' }}">
            <a href="/tools" ng-model="openTab.name" btn-radio="'tools'"><i class="fa fa-th"></i> Widget</a>
          </li>
          <li class="{{ openTab.name == 'post' ? 'active' : '' }}">
            <a href="/post" ng-model="openTab.name" btn-radio="'post'"><i class="fa fa-plus"></i> Post</a>
          </li>
          <li class="main-selected-products-container">
            <a click-action="selectedProducts = []" ng-show="selectedProducts.length" class="btn fa fa-times clear-selected-products-button" ng-click="utils.clear(selectedProducts)"></a>

            <a click-action="toggleSelectedProduct({{product.id}})" ng-click="utils.remove(selectedProducts, product)" class="main-selected-product" ng-repeat="product in selectedProducts">
              <img src="{{product.image.sizes.Small.url}}">
            </a>
          </li>
          <li>
            <a class="btn js-button btn-basic" style="background-color: gray;" ng-style="{ backgroundColor: js && 'white' }" ng-click="redirect($event)" click-action="js = !js">{{ js ? 'JS ON' : 'JS OFF' }}</a>
          </li>
        </ul>
      </nav>
    </header>

    <nav class="mobile-nav visible-xs" role="navigation">
      <ul class="nav navbar-nav">
        <li class="{{ openTab.name == 'search' ? 'active' : '' }}">
          <i class="fa fa-search"></i>
          <a href="/search">Products</a>
        </li>
        <li class="dropdown {{ openTab.name == 'tools' ? 'active' : '' }}">
          <i class="fa fa-star"></i>
          <a href="/tools">LinkStar</a>
        </li>
        <li class="{{ openTab.name == 'insights' ? 'active' : '' }}">
          <i class="fa fa-bar-chart-o"></i>
          <a href="/insights">Insights</a>
        </li>
        <li class="{{ openTab.name == 'account' ? 'active' : '' }}">
          <i class="fa fa-cog"></i>
          <a href="/account">Account</a>
        </li>
      </ul>
    </nav>

    <!-- TODO: make into template -->
    <div ng-init="openTab.name = openTab.name || 'search'" ng-click="openTab.name = $event.target == $event.currentTarget ? null : openTab.name" ng-class="{ active: openTab.name }" ng-include="'templates/main-tab-content.tpl.html'" class="main-view content-background">
    </div>
    <!-- <div class="main-view" ui-view="main"></div> -->


    <script>
      _.each(document.querySelectorAll('[data-hbs-show], [data-hbs-hide]'), function (el, index) {
        el.removeAttribute('data-hbs-show');
        el.removeAttribute('data-hbs-hide');
      });
    </script>
  </body>
</html>

